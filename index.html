<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§è±ªå·å…±å’Œå›½ å•†å“æƒ…å ±</title>
    <meta name="description" content="å¤§è±ªå·å…±å’Œå›½ã®å•†å“æƒ…å ±ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆã§ã™ã€‚å›½æ°‘ã®å‡ºå“æƒ…å ±ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å…¬é–‹ä¸­ã€‚">
    <meta name="keywords" content="å¤§è±ªå·å…±å’Œå›½, ãƒã‚¤ã‚¯ãƒ©, è²¿æ˜“, å•†å“æƒ…å ±">
    <style>
        :root {
            --mc-green: #3cfb00;
            --mc-aqua: #55ffff;
            --mc-gold: #ffaa00;
            --cyber-bg: #0d0d0d;
            --panel-bg: rgba(20, 20, 20, 0.9);
        }

        body {
            background-color: var(--cyber-bg);
            background-image:
                linear-gradient(0deg, transparent 24%, rgba(255, 255, 255, .03) 25%, rgba(255, 255, 255, .03) 26%, transparent 27%),
                linear-gradient(90deg, transparent 24%, rgba(255, 255, 255, .03) 25%, rgba(255, 255, 255, .03) 26%, transparent 27%);
            background-size: 40px 40px;
            color: #eee;
            font-family: 'Consolas', 'Courier New', monospace;
            margin: 0;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 20px 0 40px;
        }

        .header h1 {
            color: var(--mc-gold);
            font-size: 2.2rem;
            text-shadow: 0 0 15px var(--mc-gold);
            margin: 0;
            letter-spacing: 4px;
        }

        .header p { color: #666; font-size: 0.8rem; margin-top: 10px; }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
            max-width: 1200px;
            margin: 0 auto;
        }

        section {
            background: var(--panel-bg);
            border: 1px solid #333;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h2 {
            font-size: 1.1rem;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th {
            text-align: left;
            color: #888;
            font-size: 0.75rem;
            border-bottom: 2px solid #333;
            padding: 10px;
            text-transform: uppercase;
        }

        td {
            padding: 14px 10px;
            border-bottom: 1px solid #222;
            font-size: 0.9rem;
        }

        .coordinate { color: var(--mc-aqua); font-weight: bold; }
        .price { color: var(--mc-green); font-weight: bold; }
        .seller-tag { color: #777; font-size: 0.8rem; }

        .auth-panel {
            border: 1px solid var(--mc-gold);
            position: sticky;
            top: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        input, select {
            background: #000;
            border: 1px solid #444;
            color: #fff;
            padding: 12px;
            border-radius: 4px;
            font-family: inherit;
        }

        input:focus { border-color: var(--mc-gold); outline: none; }

        .btn-submit {
            background: var(--mc-gold);
            color: #000;
            border: none;
            padding: 15px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: 0.2s;
            text-transform: uppercase;
        }

        .btn-submit:hover {
            filter: brightness(1.2);
            box-shadow: 0 0 20px rgba(255, 170, 0, 0.4);
        }

        .divider { border: 0; border-top: 1px solid #333; margin: 10px 0; }

        @media (max-width: 900px) {
            .main-container { grid-template-columns: 1fr; }
            .auth-panel { position: static; }
        }
    </style>
</head>
<body>

<header class="header">
    <h1>å¤§è±ªå· å•†å“æƒ…å ±</h1>
    <p>REPUBLIC OF DAITO - OFFICIAL TRADE LOGISTICS</p>
</header>

<div class="main-container">
    <main>
        <section>
            <h2 style="color: var(--mc-aqua);"><span>Â§b</span> å•†å“æƒ…å ±</h2>
            <table>
                <thead>
                    <tr>
                        <th>å“ç›®</th>
                        <th>å˜ä¾¡</th>
                        <th>åº§æ¨™ (X/Z)</th>
                        <th>çŠ¶æ³</th>
                        <th>å‡ºå“è€…</th>
                    </tr>
                </thead>
                <tbody id="trade-tbody">
                    <tr><td colspan="5" style="text-align:center; color:#555;">ãƒ‡ãƒ¼ã‚¿æ¥ç¶šä¸­...</td></tr>
                </tbody>
            </table>
        </section>
    </main>

    <aside>
        <section class="auth-panel">
            <h2 style="color: var(--mc-gold);"><span>ğŸ”</span> å›½æ°‘å°‚ç”¨å•†å“ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ </h2>
            <div class="input-group">
                <input type="text" id="auth-mcid" placeholder="MCID">
                <input type="password" id="id-auth-pass" placeholder="ã“ã“ã«èªè¨¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" autocomplete="new-password">
                <div class="divider"></div>
                <input type="text" id="in-name" placeholder="å•†å“å">
                <input type="text" id="in-price" placeholder="ä¾¡æ ¼ ">
                <input type="text" id="in-coords" placeholder="åº§æ¨™ (X / Z)">
                <select id="in-stock">
                    <option value="åœ¨åº«ã‚ã‚Š">åœ¨åº«ã‚ã‚Š</option>
                    <option value="åœ¨åº«åƒ…å°‘">åœ¨åº«åƒ…å°‘</option>
                    <option value="å—æ³¨ç”Ÿç”£">å—æ³¨ç”Ÿç”£</option>
                </select>
                <button class="btn-submit" onclick="submitTrade()">å•†å“æƒ…å ±ã‚’ç™»éŒ²</button>
            </div>
        </section>
    </aside>
</div>

<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzngZ12yBdeHcrjQ4M976_cRCX0IeKyVFIFw7byvG0ZlAtaiKQpzP0F7mhGO2MBbl2p/exec";
    const CITIZENS = [
            "nyokki1958", "daran0289", "maikuraumai", "kenti7599", "SoftMusic096337",
            "TempOwl79825726", "SlightSum8834", "yutakabicchi", "shotaro shizoka", "Tankichi1",
            "Sora3055", "ShabbyRuby54641", "yuisyunn", "kiri5620", "xRqmuzzzL YT",
            "WoodedTuba82716", "atatan3", "Ezipt3697", "y3ur1lala", "Harukaze4006",
            "RinRin404040", "takubon0114", "ZeroPlayer1396", "K1hoOIE", "Hikaru bp",
            "kemi114", "PaltryCow795892", "haruson7856", "BleakDread23911", "FleeingRat43895",
            "Nnz0313", "shuji12324", "haruhi8395", "utte75877", "InlandVeil18339",
            "BlahColt4486", "kitune0510", "MIYUKI20107577", "HardPigeon4047", "PairedLand4913",
            "hiyorispyair", "DueMite4591", "yukiharu518817", "kouk9690", "Ram1117enter",
            "GCsTanzanite", "haha70473", "Raika6605", "hagetarouSP", "tesuteru",
            "tantanmendesu29", "Commander129632", "RINEshinki3030", "kanade0905", "mike32Ch",
            "xTZxJP"
        ];

    async function loadTradeData() {
        try {
            const res = await fetch(GAS_URL);
            const data = await res.json();
            const tbody = document.getElementById('trade-tbody');
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">ç¾åœ¨ã€ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å•†å“ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</td></tr>';
                return;
            }

            tbody.innerHTML = data.map(item => `
                <tr>
                    <td><strong style="color:#fff;">${item.name}</strong></td>
                    <td class="price">${item.price} KD</td>
                    <td class="coordinate">${item.coords}</td>
                    <td>${item.stock}</td>
                    <td class="seller-tag">${item.seller}</td>
                </tr>
            `).join('');
        } catch (e) {
            document.getElementById('trade-tbody').innerHTML = '<tr><td colspan="5" style="text-align:center; color:var(--mc-red);">é€šä¿¡ã‚¨ãƒ©ãƒ¼ï¼šæ”¿åºœã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚</td></tr>';
        }
    }

    async function submitTrade() {
        const mcid = document.getElementById('auth-mcid').value;
        const pass = document.getElementById('auth-pass').value;

        if (!CITIZENS.includes(mcid)) {
            alert("å›½æ°‘ãƒªã‚¹ãƒˆã«ç…§åˆã§ãã¾ã›ã‚“ã€‚MCIDã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
            return;
        }

        const payload = {
            seller: mcid,
            password: pass,
            name: document.getElementById('in-name').value,
            price: document.getElementById('in-price').value,
            coords: document.getElementById('in-coords').value,
            stock: document.getElementById('in-stock').value
        };

        if (!payload.name || !payload.password) {
            alert("å•†å“åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…é ˆã§ã™ã€‚");
            return;
        }

        try {
            const res = await fetch(GAS_URL, { method: "POST", body: JSON.stringify(payload) });
            const result = await res.json();
            if (result.status === "success") {
                alert("å•†å“æƒ…å ±ãŒå®Œäº†ã—ã¾ã—ãŸã€‚");
                location.reload();
            } else {
                alert("ã‚¨ãƒ©ãƒ¼: " + result.message);
            }
        } catch (e) {
            alert("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
        }
    }

    loadTradeData();
</script>

</body>
</html>

